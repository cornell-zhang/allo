<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Frontend Syntax Guide &#8212; Allo Documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic_mod.css?v=9b2032db" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=db78e746"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/js/theme.js"></script>
    <script src="../_static/js/petite-vue.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dataflow Programming" href="dataflow.html" />
    <link rel="prev" title="Vivado/Vitis HLS Backend" href="../gallery/tutorial_02_vhls.html" /> 
  </head><body data-dark_mode_code_blocks="true">

<div id="top_nav">
    

    <nav>
        
            
        

        <p id="toggle_sidebar">
            <a href="#" title="Toggle sidebar">|||</a>
        </p>
        <h1><a href="../index.html" title="Go to homepage">Allo Documentation</a></h1>
            <a id="source_link" href="https://github.com/cornell-zhang/allo">
    
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512">
            <path fill="white" d="M 244.8,8 C 106.1,8 0,113.3 0,252 c 0,110.9 69.8,205.8 169.5,239.2 12.8,2.3 17.3,-5.6 17.3,-12.1 0,-6.2 -0.3,-40.4 -0.3,-61.4 0,0 -70,15 -84.7,-29.8 0,0 -11.4,-29.1 -27.8,-36.6 0,0 -22.9,-15.7 1.6,-15.4 0,0 24.9,2 38.6,25.8 21.9,38.6 58.6,27.5 72.9,20.9 2.3,-16 8.8,-27.1 16,-33.7 -55.9,-6.2 -112.3,-14.3 -112.3,-110.5 0,-27.5 7.6,-41.3 23.6,-58.9 -2.6,-6.5 -11.1,-33.3 2.6,-67.9 20.9,-6.5 69,27 69,27 20,-5.6 41.5,-8.5 62.8,-8.5 21.3,0 42.8,2.9 62.8,8.5 0,0 48.1,-33.6 69,-27 13.7,34.7 5.2,61.4 2.6,67.9 16,17.7 25.8,31.5 25.8,58.9 0,96.5 -58.9,104.2 -114.8,110.5 9.2,7.9 17,22.9 17,46.4 0,33.7 -0.3,75.4 -0.3,83.6 0,6.5 4.6,14.4 17.3,12.1 C 428.2,457.8 496,362.9 496,252 496,113.3 383.5,8 244.8,8 Z"/>
        </svg>
    
</a>
        

        <a id="mode_toggle" href="#" @click.prevent="handleClick" :title="mode">
    <template v-if="mode == 'light'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_light"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M67.48,18.073c1.913,-1.912 1.913,-5.018 0,-6.931c-1.912,-1.912 -5.018,-1.912 -6.931,0l-6.798,6.799c-1.912,1.912 -1.912,5.018 0,6.931c1.913,1.912 5.018,1.912 6.931,-0l6.798,-6.799Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.728,61.108c1.912,-1.913 1.912,-5.018 -0,-6.931c-1.913,-1.913 -5.019,-1.913 -6.931,-0l-6.799,6.798c-1.912,1.913 -1.912,5.019 0,6.931c1.913,1.913 5.019,1.913 6.931,0l6.799,-6.798Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.682,54.177c-1.913,-1.913 -5.018,-1.913 -6.931,-0c-1.912,1.913 -1.912,5.018 0,6.931l6.798,6.798c1.913,1.913 5.019,1.913 6.931,0c1.913,-1.912 1.913,-5.018 0,-6.931l-6.798,-6.798Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M4.901,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901l-0,9.614c-0,2.705 2.196,4.901 4.9,4.901c2.705,-0 4.901,-2.196 4.901,-4.901l0,-9.614Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M18.929,11.142c-1.912,-1.912 -5.018,-1.912 -6.931,0c-1.912,1.913 -1.912,5.019 0,6.931l6.799,6.799c1.912,1.912 5.018,1.912 6.931,-0c1.912,-1.913 1.912,-5.019 -0,-6.931l-6.799,-6.799Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.108,34.623c-2.705,0 -4.901,2.196 -4.901,4.901c-0,2.705 2.196,4.901 4.901,4.901l9.614,0c2.705,0 4.901,-2.196 4.901,-4.901c-0,-2.705 -2.196,-4.901 -4.901,-4.901l-9.614,0Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'dark'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_dark"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><circle cx="39.311" cy="39.524" r="15.734" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.212,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.901,2.196 -4.901,4.901c0,2.705 2.197,4.901 4.901,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.662,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.989,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.732,61.103c1.91,-1.91 1.91,-5.011 0,-6.921l-0.009,-0.01c-1.91,-1.91 -5.012,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.909,1.91 5.011,1.91 6.92,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.672,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.52,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l-0,-0.01c-0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.212,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.901,2.196 -4.901,4.901c0,2.704 2.197,4.9 4.901,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.73,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 -0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.098,34.623c-2.699,0 -4.891,2.192 -4.891,4.892l-0,0.019c-0,2.699 2.192,4.891 4.891,4.891c2.7,0 4.892,-2.192 4.892,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.892,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>

    <template v-if="mode == 'darkest'">
        <svg width="100%" height="100%" viewBox="0 0 79 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;"><g id="mode_darkest"><rect id="Bounds" x="0" y="-0" width="78.623" height="79.049" style="fill:none;"/><path d="M39.315,23.791c8.684,-0 15.734,7.05 15.734,15.733c0,8.684 -7.05,15.734 -15.734,15.734c-8.683,0 -15.733,-7.05 -15.733,-15.734c-0,-8.683 7.05,-15.733 15.733,-15.733Zm0,4.737c6.069,0 10.997,4.927 10.997,10.996c-0,6.069 -4.928,10.996 -10.997,10.996c-6.068,0 -10.996,-4.927 -10.996,-10.996c0,-6.069 4.928,-10.996 10.996,-10.996Z" style="fill:#fff;"/><g id="beams"><g id="beam"><path id="beam1" serif:id="beam" d="M44.216,14.515c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,0 -4.9,2.196 -4.9,4.901c-0,2.705 2.196,4.901 4.9,4.901c2.705,0 4.901,-2.196 4.901,-4.901Z" style="fill:#fff;"/></g><g id="beam2" serif:id="beam"><path id="beam3" serif:id="beam" d="M60.666,24.892c1.902,-1.902 1.902,-4.99 0,-6.892l-0.04,-0.039c-1.901,-1.902 -4.989,-1.902 -6.891,-0c-1.901,1.901 -1.901,4.989 0,6.891l0.04,0.04c1.902,1.901 4.99,1.901 6.891,-0Z" style="fill:#fff;"/></g><g id="beam4" serif:id="beam"><path id="beam5" serif:id="beam" d="M25.737,61.103c1.909,-1.91 1.909,-5.011 -0,-6.921l-0.01,-0.01c-1.91,-1.91 -5.011,-1.91 -6.921,-0c-1.91,1.91 -1.91,5.011 -0,6.921l0.01,0.01c1.91,1.91 5.011,1.91 6.921,-0Z" style="fill:#fff;"/></g><g id="beam6" serif:id="beam"><path id="beam7" serif:id="beam" d="M60.676,54.167c-1.907,-1.907 -5.004,-1.907 -6.911,0l-0.02,0.02c-1.907,1.907 -1.907,5.004 0,6.911c1.907,1.907 5.004,1.907 6.911,-0l0.02,-0.02c1.907,-1.907 1.907,-5.004 0,-6.911Z" style="fill:#fff;"/></g><g id="beam8" serif:id="beam"><path id="beam9" serif:id="beam" d="M14.524,34.623c-2.702,0 -4.896,2.194 -4.896,4.896l0,0.01c0,2.702 2.194,4.896 4.896,4.896c2.702,0 4.896,-2.194 4.896,-4.896l0,-0.01c0,-2.702 -2.194,-4.896 -4.896,-4.896Z" style="fill:#fff;"/></g><g id="beam10" serif:id="beam"><path id="beam11" serif:id="beam" d="M44.216,64.534c0,-2.705 -2.196,-4.901 -4.901,-4.901c-2.704,-0 -4.9,2.196 -4.9,4.901c-0,2.704 2.196,4.9 4.9,4.9c2.705,0 4.901,-2.196 4.901,-4.9Z" style="fill:#fff;"/></g><g id="beam12" serif:id="beam"><path id="beam13" serif:id="beam" d="M25.734,17.943c-1.911,-1.911 -5.015,-1.911 -6.926,0l-0.005,0.005c-1.911,1.911 -1.911,5.015 0,6.926c1.911,1.911 5.015,1.911 6.926,0l0.005,-0.005c1.911,-1.911 1.911,-5.014 0,-6.926Z" style="fill:#fff;"/></g><g id="beam14" serif:id="beam"><path id="beam15" serif:id="beam" d="M64.103,34.623c-2.7,0 -4.892,2.192 -4.892,4.892l-0,0.019c-0,2.699 2.192,4.891 4.892,4.891c2.699,0 4.891,-2.192 4.891,-4.891l0,-0.019c0,-2.7 -2.192,-4.892 -4.891,-4.892Z" style="fill:#fff;"/></g></g></g></svg>
    </template>
</a>

<script>
(function() {
    const LOCAL_STORAGE_KEY = 'piccoloThemeMode'

    var initialMode = localStorage.getItem(LOCAL_STORAGE_KEY)

    if (initialMode) {
        // Make sure the value in local storage is valid
        if (['light', 'dark', 'darkest'].indexOf(initialMode) == -1) {
            initialMode = 'light'
            localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
        }
    } else {
        // Check if the client prefers dark mode
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            initialMode = 'dark'
        } else {
            initialMode = 'light'
        }
        localStorage.setItem(LOCAL_STORAGE_KEY, initialMode)
    }

    document.documentElement.dataset.mode = initialMode

    PetiteVue.createApp({
        'mode': initialMode,
        handleClick() {
            let currentMode = this.mode

            if (currentMode == 'light') {
                this.mode = 'dark'
            } else if (currentMode == 'dark') {
                this.mode = 'darkest'
            } else if (currentMode == 'darkest') {
                this.mode = 'light'
            }

            document.documentElement.dataset.mode = this.mode
            localStorage.setItem(LOCAL_STORAGE_KEY, this.mode)

            console.log(this.mode)
        }
    }).mount('#mode_toggle')
})()
</script>
            <p class="mobile_search_link">
                <a href="../search.html" title="Search">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 65 64" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2">
                        <path d="M14.873 40.009c-2.315-3.943-3.642-8.532-3.642-13.429C11.231 11.91 23.141 0 37.811 0s26.58 11.91 26.58 26.58-11.91 26.58-26.58 26.58a26.44 26.44 0 0 1-14.277-4.161L9.739 62.794a3.12 3.12 0 0 1-4.413 0L.913 58.382c-1.217-1.218-1.217-3.196 0-4.413l13.96-13.96zM37.811 8.054c10.225 0 18.526 8.301 18.526 18.526s-8.301 18.526-18.526 18.526-18.526-8.301-18.526-18.526S27.586 8.054 37.811 8.054z" fill="#fff" />
                    </svg>
                </a>
            </p>
        

        <div class="searchbox_wrapper">
            
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
    </nav>
</div>

    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gallery/tutorial_01_get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/tutorial_02_vhls.html">Vivado/Vitis HLS Backend</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deep Dive</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Frontend Syntax Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataflow.html">Dataflow Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/dive_01_data_types.html">Data Types and Type Casting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/dive_02_template.html">Template Kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/dive_03_composition.html">Kernel Composition</a></li>
<li class="toctree-l1"><a class="reference internal" href="ip.html">IP Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="pytorch.html">PyTorch Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/dive_05_verifier.html">Equivalence Checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/dive_04_features.html">Other Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Backends</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../backends/llvm.html">LLVM (CPU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backends/vitis.html">AMD Vitis HLS (FPGA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backends/catapult.html">Siemens Catapult HLS (FPGA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backends/tapa.html">RapidStream TAPA (FPGA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backends/xls.html">Google XLS (ASIC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backends/simulator.html">Multi-Threaded Simulator (CPU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backends/aie/index.html">AMD MLIR-AIE (AI Engine)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Developer Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/developer_01_ir_builder.html">IR Builder Walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gallery/developer_02_mlir.html">MLIR Translation Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Schedule Primitives</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html#data-types">Data Types</a></li>
</ul>

        </div>
      </div>


    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="frontend-syntax-guide">
<h1>Frontend Syntax Guide<a class="headerlink" href="#frontend-syntax-guide" title="Link to this heading"><span>¶</span></a></h1>
<p>This document provides a comprehensive reference for the Allo frontend syntax and semantics.
Allo uses a Python-based domain-specific language (DSL) that requires <strong>strict type annotations</strong>
to enable hardware synthesis and optimization.</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#function-definition" id="id1">Function Definition</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-function-signature" id="id2">Basic Function Signature</a></p></li>
<li><p><a class="reference internal" href="#multiple-return-values" id="id3">Multiple Return Values</a></p></li>
<li><p><a class="reference internal" href="#no-return-value" id="id4">No Return Value</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#variable-declaration-and-assignment" id="id5">Variable Declaration and Assignment</a></p>
<ul>
<li><p><a class="reference internal" href="#scalar-variables" id="id6">Scalar Variables</a></p></li>
<li><p><a class="reference internal" href="#tensor-variables" id="id7">Tensor Variables</a></p></li>
<li><p><a class="reference internal" href="#initialization-from-lists-and-numpy-arrays" id="id8">Initialization from Lists and NumPy Arrays</a></p></li>
<li><p><a class="reference internal" href="#copy-semantics" id="id9">Copy Semantics</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#loop-constructs" id="id10">Loop Constructs</a></p>
<ul>
<li><p><a class="reference internal" href="#range-loops" id="id11">Range Loops</a></p></li>
<li><p><a class="reference internal" href="#variable-loop-bounds" id="id12">Variable Loop Bounds</a></p></li>
<li><p><a class="reference internal" href="#grid-loops" id="id13">Grid Loops</a></p></li>
<li><p><a class="reference internal" href="#while-loops" id="id14">While Loops</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#conditional-statements" id="id15">Conditional Statements</a></p>
<ul>
<li><p><a class="reference internal" href="#if-elif-else" id="id16">If-Elif-Else</a></p></li>
<li><p><a class="reference internal" href="#logical-operators" id="id17">Logical Operators</a></p></li>
<li><p><a class="reference internal" href="#select-expression-ternary" id="id18">Select Expression (Ternary)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#operators" id="id19">Operators</a></p>
<ul>
<li><p><a class="reference internal" href="#arithmetic-operators" id="id20">Arithmetic Operators</a></p></li>
<li><p><a class="reference internal" href="#unary-operators" id="id21">Unary Operators</a></p></li>
<li><p><a class="reference internal" href="#comparison-operators" id="id22">Comparison Operators</a></p></li>
<li><p><a class="reference internal" href="#bitwise-operators" id="id23">Bitwise Operators</a></p></li>
<li><p><a class="reference internal" href="#augmented-assignment" id="id24">Augmented Assignment</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#array-and-tensor-operations" id="id25">Array and Tensor Operations</a></p>
<ul>
<li><p><a class="reference internal" href="#indexing" id="id26">Indexing</a></p></li>
<li><p><a class="reference internal" href="#subviews" id="id27">Subviews</a></p></li>
<li><p><a class="reference internal" href="#slicing" id="id28">Slicing</a></p></li>
<li><p><a class="reference internal" href="#bit-operations-on-integers" id="id29">Bit Operations on Integers</a></p></li>
<li><p><a class="reference internal" href="#dynamic-shapes" id="id30">Dynamic Shapes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#nested-functions" id="id31">Nested Functions</a></p>
<ul>
<li><p><a class="reference internal" href="#index-arguments" id="id32">Index Arguments</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#built-in-functions" id="id33">Built-in Functions</a></p>
<ul>
<li><p><a class="reference internal" href="#min-and-max" id="id34">Min and Max</a></p></li>
<li><p><a class="reference internal" href="#broadcast-binary-operations" id="id35">Broadcast Binary Operations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#constexpr-compile-time-constants" id="id36">ConstExpr (Compile-Time Constants)</a></p>
<ul>
<li><p><a class="reference internal" href="#constexpr-arithmetic" id="id37">ConstExpr Arithmetic</a></p></li>
<li><p><a class="reference internal" href="#dependent-constexpr" id="id38">Dependent ConstExpr</a></p></li>
<li><p><a class="reference internal" href="#using-helper-functions" id="id39">Using Helper Functions</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#scoping-rules" id="id40">Scoping Rules</a></p>
<ul>
<li><p><a class="reference internal" href="#reassignment-validity" id="id41">Reassignment Validity</a></p></li>
<li><p><a class="reference internal" href="#valid-scoping" id="id42">Valid Scoping</a></p></li>
<li><p><a class="reference internal" href="#invalid-scoping" id="id43">Invalid Scoping</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#meta-programming-constructs" id="id44">Meta-Programming Constructs</a></p>
<ul>
<li><p><a class="reference internal" href="#meta-if-elif-else" id="id45">Meta If/Elif/Else</a></p></li>
<li><p><a class="reference internal" href="#meta-for-compile-time-loop-unrolling" id="id46">Meta For (Compile-Time Loop Unrolling)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tensor-attributes-and-methods" id="id47">Tensor Attributes and Methods</a></p>
<ul>
<li><p><a class="reference internal" href="#transpose-t" id="id48">Transpose (.T)</a></p></li>
<li><p><a class="reference internal" href="#copy-copy" id="id49">Copy (.copy)</a></p></li>
<li><p><a class="reference internal" href="#bit-reverse-reverse" id="id50">Bit Reverse (.reverse)</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#type-conversion-functions" id="id51">Type Conversion Functions</a></p>
<ul>
<li><p><a class="reference internal" href="#explicit-type-casting" id="id52">Explicit Type Casting</a></p></li>
<li><p><a class="reference internal" href="#fixed-point-type-attributes" id="id53">Fixed-Point Type Attributes</a></p></li>
<li><p><a class="reference internal" href="#bitcast" id="id54">Bitcast</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#library-operations" id="id55">Library Operations</a></p>
<ul>
<li><p><a class="reference internal" href="#matrix-operations" id="id56">Matrix Operations</a></p></li>
<li><p><a class="reference internal" href="#tensor-manipulation" id="id57">Tensor Manipulation</a></p></li>
<li><p><a class="reference internal" href="#element-wise-operations" id="id58">Element-wise Operations</a></p></li>
<li><p><a class="reference internal" href="#neural-network-operations" id="id59">Neural Network Operations</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#templates-and-type-parameters" id="id60">Templates and Type Parameters</a></p></li>
<li><p><a class="reference internal" href="#building-and-execution" id="id61">Building and Execution</a></p></li>
</ul>
</nav>
<section id="function-definition">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Function Definition</a><a class="headerlink" href="#function-definition" title="Link to this heading"><span>¶</span></a></h2>
<section id="basic-function-signature">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Basic Function Signature</a><a class="headerlink" href="#basic-function-signature" title="Link to this heading"><span>¶</span></a></h3>
<p>Allo kernels are defined as Python functions with explicit type annotations for all arguments and return types.
Arguments and return types can be scalar or tensor types. The syntax follows Python’s type hint notation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">arg1</span><span class="p">:</span> <span class="n">Type1</span><span class="p">[</span><span class="n">Shape1</span><span class="p">],</span> <span class="n">arg2</span><span class="p">:</span> <span class="n">ScalarType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ReturnType</span><span class="p">[</span><span class="n">Shape</span><span class="p">]:</span>
    <span class="c1"># function body</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
<p><strong>Example: Scalar Arguments</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">A</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p><strong>Example: Matrix Multiplication</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">allo.ir.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">int32</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gemm</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">]:</span>
    <span class="n">C</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">allo</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
        <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">C</span>
</pre></div>
</div>
</section>
<section id="multiple-return-values">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Multiple Return Values</a><a class="headerlink" href="#multiple-return-values" title="Link to this heading"><span>¶</span></a></h3>
<p>Functions can return multiple values as a tuple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">],</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">]):</span>
    <span class="n">res0</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">res1</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
        <span class="n">res0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">res1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">res0</span><span class="p">,</span> <span class="n">res1</span>
</pre></div>
</div>
<p>The caller can unpack the returned tuple:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">callee</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<p>To ignore certain return values, use underscore:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">callee</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Ignore second return value</span>
</pre></div>
</div>
</section>
<section id="no-return-value">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">No Return Value</a><a class="headerlink" href="#no-return-value" title="Link to this heading"><span>¶</span></a></h3>
<p>Functions that don’t return a value can omit the return type annotation, use <code class="docutils literal notranslate"><span class="pre">-&gt;</span> <span class="pre">None</span></code>,
or have an empty return:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">]):</span>
    <span class="k">pass</span>  <span class="c1"># No return</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">return</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">]):</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
</section>
<section id="variable-declaration-and-assignment">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Variable Declaration and Assignment</a><a class="headerlink" href="#variable-declaration-and-assignment" title="Link to this heading"><span>¶</span></a></h2>
<section id="scalar-variables">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Scalar Variables</a><a class="headerlink" href="#scalar-variables" title="Link to this heading"><span>¶</span></a></h3>
<p>Scalar variables are declared using Python’s type annotation syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Declaration with initialization</span>
<span class="n">x</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y</span><span class="p">:</span> <span class="n">float32</span> <span class="o">=</span> <span class="mf">3.14</span>

<span class="c1"># Declaration without initialization</span>
<span class="n">z</span><span class="p">:</span> <span class="n">int32</span>

<span class="c1"># Assignment after declaration</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
</section>
<section id="tensor-variables">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Tensor Variables</a><a class="headerlink" href="#tensor-variables" title="Link to this heading"><span>¶</span></a></h3>
<p>Tensors are declared with their shape in the type annotation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1D tensor</span>
<span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># 2D tensor initialized to zero</span>
<span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># 4D tensor</span>
<span class="n">C</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
<section id="initialization-from-lists-and-numpy-arrays">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Initialization from Lists and NumPy Arrays</a><a class="headerlink" href="#initialization-from-lists-and-numpy-arrays" title="Link to this heading"><span>¶</span></a></h3>
<p>Tensors can be initialized from Python lists or NumPy arrays:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># From nested list (compile-time constant)</span>
<span class="n">tmp</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>

<span class="c1"># From NumPy array (global constant)</span>
<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="n">tmp</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr</span>
    <span class="k">return</span> <span class="n">tmp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="c1"># Constant tensor slicing</span>
<span class="n">np_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
    <span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">np_A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Load second row as constant</span>
    <span class="k">return</span> <span class="n">A</span>
</pre></div>
</div>
</section>
<section id="copy-semantics">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Copy Semantics</a><a class="headerlink" href="#copy-semantics" title="Link to this heading"><span>¶</span></a></h3>
<p>Tensors can be copied by assignment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">outp</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span>  <span class="c1"># Copy temp to outp</span>

<span class="c1"># Copy from argument</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">inp</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">]:</span>
    <span class="n">outp</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="n">inp</span>
    <span class="k">return</span> <span class="n">outp</span>
</pre></div>
</div>
</section>
</section>
<section id="loop-constructs">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Loop Constructs</a><a class="headerlink" href="#loop-constructs" title="Link to this heading"><span>¶</span></a></h2>
<section id="range-loops">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Range Loops</a><a class="headerlink" href="#range-loops" title="Link to this heading"><span>¶</span></a></h3>
<p>Standard Python <code class="docutils literal notranslate"><span class="pre">range</span></code> loops are supported with one, two, or three arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># range(end)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

<span class="c1"># range(start, end)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

<span class="c1"># range(start, end, step)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">break</span></code> and <code class="docutils literal notranslate"><span class="pre">continue</span></code> are <strong>not supported</strong> in Allo.</p>
</div>
</section>
<section id="variable-loop-bounds">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Variable Loop Bounds</a><a class="headerlink" href="#variable-loop-bounds" title="Link to this heading"><span>¶</span></a></h3>
<p>Loop bounds can be runtime variables:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>  <span class="c1"># Variable lower bound</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>  <span class="c1"># Variable lower bound</span>
                <span class="n">A</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">j</span>

<span class="c1"># Bounds from array elements</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">10</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>  <span class="c1"># Bounds from array</span>
            <span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">i</span>
</pre></div>
</div>
</section>
<section id="grid-loops">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Grid Loops</a><a class="headerlink" href="#grid-loops" title="Link to this heading"><span>¶</span></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">allo.grid</span></code> provides a shorthand for nested loops:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Equivalent to three nested for loops</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">allo</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">):</span>
    <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>

<span class="c1"># 2D grid</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">allo</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Named grids are useful for applying schedule optimizations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">allo</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;C&quot;</span><span class="p">):</span>
    <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="while-loops">
<h3><a class="toc-backref" href="#id14" role="doc-backlink">While Loops</a><a class="headerlink" href="#while-loops" title="Link to this heading"><span>¶</span></a></h3>
<p>While loops with runtime conditions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">allo.ir.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">index</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]):</span>
    <span class="n">i</span><span class="p">:</span> <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
</section>
<section id="conditional-statements">
<h2><a class="toc-backref" href="#id15" role="doc-backlink">Conditional Statements</a><a class="headerlink" href="#conditional-statements" title="Link to this heading"><span>¶</span></a></h2>
<section id="if-elif-else">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">If-Elif-Else</a><a class="headerlink" href="#if-elif-else" title="Link to this heading"><span>¶</span></a></h3>
<p>Standard Python conditional syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">int32</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># Nested conditional</span>
            <span class="n">r</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</section>
<section id="logical-operators">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">Logical Operators</a><a class="headerlink" href="#logical-operators" title="Link to this heading"><span>¶</span></a></h3>
<p>Conditions can use <code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">or</span></code>, and <code class="docutils literal notranslate"><span class="pre">not</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">elif</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">2</span>
<span class="k">elif</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Multiple conditions can be chained:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="select-expression-ternary">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Select Expression (Ternary)</a><a class="headerlink" href="#select-expression-ternary" title="Link to this heading"><span>¶</span></a></h3>
<p>Python’s ternary expression for conditional assignment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="c1"># With type casting</span>
<span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
</pre></div>
</div>
</section>
</section>
<section id="operators">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Operators</a><a class="headerlink" href="#operators" title="Link to this heading"><span>¶</span></a></h2>
<section id="arithmetic-operators">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Arithmetic Operators</a><a class="headerlink" href="#arithmetic-operators" title="Link to this heading"><span>¶</span></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td><p>Addition</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p>Subtraction</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">b</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td><p>Multiplication</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">b</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">/</span></code></p></td>
<td><p>Division (float)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">/</span> <span class="pre">b</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">//</span></code></p></td>
<td><p>Floor division</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">//</span> <span class="pre">b</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%</span></code></p></td>
<td><p>Modulo</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">%</span> <span class="pre">b</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="unary-operators">
<h3><a class="toc-backref" href="#id21" role="doc-backlink">Unary Operators</a><a class="headerlink" href="#unary-operators" title="Link to this heading"><span>¶</span></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vi</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Negation</span>
<span class="n">result</span> <span class="o">=</span> <span class="o">+</span><span class="p">(</span><span class="n">vi</span> <span class="o">+</span> <span class="n">vf</span><span class="p">)</span>   <span class="c1"># Unary plus</span>
</pre></div>
</div>
</section>
<section id="comparison-operators">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Comparison Operators</a><a class="headerlink" href="#comparison-operators" title="Link to this heading"><span>¶</span></a></h3>
<p>All standard comparison operators are supported: <code class="docutils literal notranslate"><span class="pre">==</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></p>
</section>
<section id="bitwise-operators">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Bitwise Operators</a><a class="headerlink" href="#bitwise-operators" title="Link to this heading"><span>¶</span></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;&lt;</span></code></p></td>
<td><p>Left shift</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">&lt;&lt;</span> <span class="pre">v</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&gt;&gt;</span></code></p></td>
<td><p>Right shift</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">64</span> <span class="pre">&gt;&gt;</span> <span class="pre">v</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&amp;</span></code></p></td>
<td><p>Bitwise AND</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">&amp;</span> <span class="pre">v</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">|</span></code></p></td>
<td><p>Bitwise OR</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">|</span> <span class="pre">v</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">^</span></code></p></td>
<td><p>Bitwise XOR</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">^</span> <span class="pre">b</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="augmented-assignment">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Augmented Assignment</a><a class="headerlink" href="#augmented-assignment" title="Link to this heading"><span>¶</span></a></h3>
<p>All augmented assignment operators work on both scalars and tensor elements:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">B</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
</section>
<section id="array-and-tensor-operations">
<h2><a class="toc-backref" href="#id25" role="doc-backlink">Array and Tensor Operations</a><a class="headerlink" href="#array-and-tensor-operations" title="Link to this heading"><span>¶</span></a></h2>
<section id="indexing">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Indexing</a><a class="headerlink" href="#indexing" title="Link to this heading"><span>¶</span></a></h3>
<p>Standard multi-dimensional indexing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">value</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
</div>
</section>
<section id="subviews">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">Subviews</a><a class="headerlink" href="#subviews" title="Link to this heading"><span>¶</span></a></h3>
<p>Accessing a sub-array by partial indexing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># Returns row 5 as 1D array</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">float32</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>  <span class="c1"># Returns a 1D slice</span>
</pre></div>
</div>
<p>Dynamic subviews with variable indices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">i</span><span class="p">:</span> <span class="n">index</span><span class="p">,</span> <span class="n">j</span><span class="p">:</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">float32</span><span class="p">[</span><span class="mi">15</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="slicing">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">Slicing</a><a class="headerlink" href="#slicing" title="Link to this heading"><span>¶</span></a></h3>
<p>Sub-tensor assignment using slices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">slice_copy</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>
    <span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span>  <span class="c1"># Copy B into a slice of A</span>
    <span class="k">return</span> <span class="n">A</span>
</pre></div>
</div>
</section>
<section id="bit-operations-on-integers">
<h3><a class="toc-backref" href="#id29" role="doc-backlink">Bit Operations on Integers</a><a class="headerlink" href="#bit-operations-on-integers" title="Link to this heading"><span>¶</span></a></h3>
<p>Access individual bits or bit ranges:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>      <span class="c1"># Access bit 0</span>
<span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>    <span class="c1"># Assign to bits 0-1 (upper bound exclusive)</span>
</pre></div>
</div>
</section>
<section id="dynamic-shapes">
<h3><a class="toc-backref" href="#id30" role="doc-backlink">Dynamic Shapes</a><a class="headerlink" href="#dynamic-shapes" title="Link to this heading"><span>¶</span></a></h3>
<p>For functions that accept tensors of unknown size at compile time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">B</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">size</span><span class="p">:</span> <span class="n">int32</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
        <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="nested-functions">
<h2><a class="toc-backref" href="#id31" role="doc-backlink">Nested Functions</a><a class="headerlink" href="#nested-functions" title="Link to this heading"><span>¶</span></a></h2>
<p>Functions can be defined inside kernels:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span>
    <span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">B</span>
</pre></div>
</div>
<section id="index-arguments">
<h3><a class="toc-backref" href="#id32" role="doc-backlink">Index Arguments</a><a class="headerlink" href="#index-arguments" title="Link to this heading"><span>¶</span></a></h3>
<p>Use the <code class="docutils literal notranslate"><span class="pre">index</span></code> type for loop indices passed to functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">allo.ir.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">index</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span>
    <span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="n">A_</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">x</span><span class="p">:</span> <span class="n">index</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
        <span class="n">C</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A_</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">C</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">B</span>
</pre></div>
</div>
</section>
</section>
<section id="built-in-functions">
<h2><a class="toc-backref" href="#id33" role="doc-backlink">Built-in Functions</a><a class="headerlink" href="#built-in-functions" title="Link to this heading"><span>¶</span></a></h2>
<section id="min-and-max">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">Min and Max</a><a class="headerlink" href="#min-and-max" title="Link to this heading"><span>¶</span></a></h3>
<p>Element-wise minimum and maximum:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">min_val</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
<span class="n">max_val</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">max_val</span><span class="p">,</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<p>Type promotion is handled automatically:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>      <span class="c1"># int8 with int</span>
<span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>    <span class="c1"># int8 with float -&gt; float comparison</span>
</pre></div>
</div>
</section>
<section id="broadcast-binary-operations">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">Broadcast Binary Operations</a><a class="headerlink" href="#broadcast-binary-operations" title="Link to this heading"><span>¶</span></a></h3>
<p>Apply element-wise operations across tensors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Chained broadcast operations</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">allo</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="n">allo</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">allo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Nested operations</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">allo</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">allo</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">allo</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">A</span><span class="p">))))</span>
</pre></div>
</div>
</section>
</section>
<section id="constexpr-compile-time-constants">
<h2><a class="toc-backref" href="#id36" role="doc-backlink">ConstExpr (Compile-Time Constants)</a><a class="headerlink" href="#constexpr-compile-time-constants" title="Link to this heading"><span>¶</span></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">ConstExpr</span></code> declares compile-time constant values that can be used in loop bounds:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">allo.ir.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ConstExpr</span><span class="p">,</span> <span class="n">int32</span>

<span class="n">M</span> <span class="o">=</span> <span class="mi">10</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]:</span>
    <span class="n">limit</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">B</span><span class="p">:</span> <span class="n">int32</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">limit</span><span class="p">):</span>  <span class="c1"># Loop bound is constant 5</span>
        <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
        <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">B</span>
</pre></div>
</div>
<section id="constexpr-arithmetic">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">ConstExpr Arithmetic</a><a class="headerlink" href="#constexpr-arithmetic" title="Link to this heading"><span>¶</span></a></h3>
<p>ConstExpr values can be computed from other ConstExpr values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">base</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">mult</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">offset</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">base</span> <span class="o">*</span> <span class="n">mult</span>  <span class="c1"># Computed at compile time: 6</span>
</pre></div>
</div>
</section>
<section id="dependent-constexpr">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">Dependent ConstExpr</a><a class="headerlink" href="#dependent-constexpr" title="Link to this heading"><span>¶</span></a></h3>
<p>ConstExpr can depend on previously defined ConstExpr:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">M</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span> <span class="o">+</span> <span class="mi">2</span>  <span class="c1"># 6</span>
<span class="n">K</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">int32</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">2</span>  <span class="c1"># 8</span>
</pre></div>
</div>
</section>
<section id="using-helper-functions">
<h3><a class="toc-backref" href="#id39" role="doc-backlink">Using Helper Functions</a><a class="headerlink" href="#using-helper-functions" title="Link to this heading"><span>¶</span></a></h3>
<p>Python helper functions can compute ConstExpr values at compile time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>

<span class="k">def</span><span class="w"> </span><span class="nf">compute_coefficient</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">i</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">B</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="mi">8</span><span class="p">]):</span>
    <span class="k">with</span> <span class="n">allo</span><span class="o">.</span><span class="n">meta_for</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
        <span class="n">coef</span><span class="p">:</span> <span class="n">ConstExpr</span><span class="p">[</span><span class="n">float32</span><span class="p">]</span> <span class="o">=</span> <span class="n">compute_coefficient</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">coef</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ConstExpr variables <strong>must</strong> be initialized at declaration time. Uninitialized ConstExpr will raise an error.</p>
</div>
</section>
</section>
<section id="scoping-rules">
<h2><a class="toc-backref" href="#id40" role="doc-backlink">Scoping Rules</a><a class="headerlink" href="#scoping-rules" title="Link to this heading"><span>¶</span></a></h2>
<p>Allo enforces C++-style <strong>Block Scoping</strong> rules, which differs from standard Python.</p>
<ul class="simple">
<li><p><strong>Scope Boundaries</strong>: <code class="docutils literal notranslate"><span class="pre">if</span></code>, <code class="docutils literal notranslate"><span class="pre">elif</span></code>, <code class="docutils literal notranslate"><span class="pre">else</span></code>, <code class="docutils literal notranslate"><span class="pre">for</span></code>, <code class="docutils literal notranslate"><span class="pre">while</span></code>, <code class="docutils literal notranslate"><span class="pre">meta_if</span></code>, <code class="docutils literal notranslate"><span class="pre">meta_for</span></code>, <code class="docutils literal notranslate"><span class="pre">meta_else</span></code>.</p></li>
<li><p><strong>Rule</strong>: A variable declared for the first time inside a block is <strong>local</strong> to that block. It is not visible after the block exits.</p></li>
<li><p><strong>Access</strong>: Inner blocks can read/write variables defined in outer blocks.</p></li>
</ul>
<section id="reassignment-validity">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">Reassignment Validity</a><a class="headerlink" href="#reassignment-validity" title="Link to this heading"><span>¶</span></a></h3>
<ul class="simple">
<li><p>A variable can be reassigned.</p></li>
<li><p>The new value must match the declared type of the variable.</p></li>
<li><p><strong>Immutable Constants</strong>: <code class="docutils literal notranslate"><span class="pre">ConstExpr</span></code> variables and values returned by <code class="docutils literal notranslate"><span class="pre">df.get_pid()</span></code> are compile-time constants and cannot be reassigned.</p></li>
</ul>
</section>
<section id="valid-scoping">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">Valid Scoping</a><a class="headerlink" href="#valid-scoping" title="Link to this heading"><span>¶</span></a></h3>
<p>Variables should be declared in the scope where they are used:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Declare outside conditional</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
<p>Local variables within a branch are allowed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="n">r</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">t</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Local to if-branch</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">t</span>
    <span class="k">return</span> <span class="n">r</span>
</pre></div>
</div>
</section>
<section id="invalid-scoping">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">Invalid Scoping</a><a class="headerlink" href="#invalid-scoping" title="Link to this heading"><span>¶</span></a></h3>
<p>The following patterns will raise errors:</p>
<p><strong>Declaring the same variable in multiple branches:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ERROR: r is not accessible outside branches</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">r</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">r</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="k">return</span> <span class="n">r</span>  <span class="c1"># Error: r not in scope</span>
</pre></div>
</div>
<p><strong>Using loop-local variables outside the loop:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ERROR: tmp is not accessible outside loop</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">tmp</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">tmp</span>  <span class="c1"># Error: tmp not in scope</span>
</pre></div>
</div>
<p><strong>Redefining loop variables in nested loops:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># ERROR: Cannot redefine i in nested loop</span>
<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">int32</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="n">s</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>  <span class="c1"># Error: i already defined</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">+</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">s</span>
</pre></div>
</div>
</section>
</section>
<section id="meta-programming-constructs">
<h2><a class="toc-backref" href="#id44" role="doc-backlink">Meta-Programming Constructs</a><a class="headerlink" href="#meta-programming-constructs" title="Link to this heading"><span>¶</span></a></h2>
<p>Allo provides compile-time meta-programming constructs that are evaluated during compilation,
enabling conditional code generation and advanced optimizations.</p>
<section id="meta-if-elif-else">
<h3><a class="toc-backref" href="#id45" role="doc-backlink">Meta If/Elif/Else</a><a class="headerlink" href="#meta-if-elif-else" title="Link to this heading"><span>¶</span></a></h3>
<p>Compile-time conditionals that generate different code based on conditions known at compile time. The conditions must be compile-time constants:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">allo</span><span class="o">.</span><span class="n">meta_if</span><span class="p">(</span><span class="n">condition1</span><span class="p">):</span>
    <span class="c1"># Code generated only when condition1 is true</span>
    <span class="k">pass</span>

<span class="k">with</span> <span class="n">allo</span><span class="o">.</span><span class="n">meta_elif</span><span class="p">(</span><span class="n">condition2</span><span class="p">):</span>
    <span class="c1"># Code generated only when condition1 is false and condition2 is true</span>
    <span class="k">pass</span>

<span class="k">with</span> <span class="n">allo</span><span class="o">.</span><span class="n">meta_else</span><span class="p">():</span>
    <span class="c1"># Code generated when all previous conditions are false</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>These are useful for:</p>
<ul class="simple">
<li><p>Selecting different implementations based on compile-time parameters</p></li>
<li><p>Specializing kernels for specific data types or array sizes</p></li>
<li><p>Eliminating dead code at compile time</p></li>
</ul>
</section>
<section id="meta-for-compile-time-loop-unrolling">
<h3><a class="toc-backref" href="#id46" role="doc-backlink">Meta For (Compile-Time Loop Unrolling)</a><a class="headerlink" href="#meta-for-compile-time-loop-unrolling" title="Link to this heading"><span>¶</span></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">allo.meta_for</span></code> supports multiple argument formats similar to Python’s <code class="docutils literal notranslate"><span class="pre">range</span></code>. The loop bounds and step must be compile-time constants:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Single argument: meta_for(upper)</span>
<span class="k">with</span> <span class="n">allo</span><span class="o">.</span><span class="n">meta_for</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

<span class="c1"># Two arguments: meta_for(lower, upper)</span>
<span class="k">with</span> <span class="n">allo</span><span class="o">.</span><span class="n">meta_for</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>

<span class="c1"># Three arguments: meta_for(lower, upper, step)</span>
<span class="k">with</span> <span class="n">allo</span><span class="o">.</span><span class="n">meta_for</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">i</span><span class="p">:</span>
    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</section>
</section>
<section id="tensor-attributes-and-methods">
<h2><a class="toc-backref" href="#id47" role="doc-backlink">Tensor Attributes and Methods</a><a class="headerlink" href="#tensor-attributes-and-methods" title="Link to this heading"><span>¶</span></a></h2>
<p>Allo provides several built-in attributes and methods for tensor manipulation.</p>
<section id="transpose-t">
<h3><a class="toc-backref" href="#id48" role="doc-backlink">Transpose (.T)</a><a class="headerlink" href="#transpose-t" title="Link to this heading"><span>¶</span></a></h3>
<p>Transpose a tensor by reversing its dimensions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">float32</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">float32</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># Transpose: shape becomes [4, 3]</span>
</pre></div>
</div>
</section>
<section id="copy-copy">
<h3><a class="toc-backref" href="#id49" role="doc-backlink">Copy (.copy)</a><a class="headerlink" href="#copy-copy" title="Link to this heading"><span>¶</span></a></h3>
<p>Create a copy of a tensor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="bit-reverse-reverse">
<h3><a class="toc-backref" href="#id50" role="doc-backlink">Bit Reverse (.reverse)</a><a class="headerlink" href="#bit-reverse-reverse" title="Link to this heading"><span>¶</span></a></h3>
<p>Reverse the bits of an integer value (useful for FFT algorithms):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">reversed_bits</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reverse</span>
</pre></div>
</div>
</section>
</section>
<section id="type-conversion-functions">
<h2><a class="toc-backref" href="#id51" role="doc-backlink">Type Conversion Functions</a><a class="headerlink" href="#type-conversion-functions" title="Link to this heading"><span>¶</span></a></h2>
<section id="explicit-type-casting">
<h3><a class="toc-backref" href="#id52" role="doc-backlink">Explicit Type Casting</a><a class="headerlink" href="#explicit-type-casting" title="Link to this heading"><span>¶</span></a></h3>
<p>Use Python built-in functions for explicit type casting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cast to float32</span>
<span class="n">b</span><span class="p">:</span> <span class="n">float32</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="c1"># Cast to int32</span>
<span class="n">c</span><span class="p">:</span> <span class="n">int32</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="fixed-point-type-attributes">
<h3><a class="toc-backref" href="#id53" role="doc-backlink">Fixed-Point Type Attributes</a><a class="headerlink" href="#fixed-point-type-attributes" title="Link to this heading"><span>¶</span></a></h3>
<p>Access type metadata for fixed-point types:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">allo.ir.types</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fixed</span>

<span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">:</span> <span class="n">Fixed</span><span class="p">[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">int32</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">.</span><span class="n">bits</span>   <span class="c1"># Returns 16 (total bitwidth)</span>
    <span class="c1"># A.fracs would return 8 (fractional bits)</span>
</pre></div>
</div>
</section>
<section id="bitcast">
<h3><a class="toc-backref" href="#id54" role="doc-backlink">Bitcast</a><a class="headerlink" href="#bitcast" title="Link to this heading"><span>¶</span></a></h3>
<p>Reinterpret the bit pattern of a value as a different type (preserves bits, changes interpretation):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reinterpret float32 bits as int32</span>
<span class="n">int_bits</span> <span class="o">=</span> <span class="n">float_val</span><span class="o">.</span><span class="n">bitcast</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">bitcast</span></code> preserves the bit pattern but changes the type interpretation.
This is different from type casting which preserves the value but may change the bits.</p>
</div>
</section>
</section>
<section id="library-operations">
<h2><a class="toc-backref" href="#id55" role="doc-backlink">Library Operations</a><a class="headerlink" href="#library-operations" title="Link to this heading"><span>¶</span></a></h2>
<p>Allo provides high-level library operations that map to optimized implementations.</p>
<section id="matrix-operations">
<h3><a class="toc-backref" href="#id56" role="doc-backlink">Matrix Operations</a><a class="headerlink" href="#matrix-operations" title="Link to this heading"><span>¶</span></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matrix multiplication</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>

<span class="c1"># Batch matrix multiplication</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">bmm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>

<span class="c1"># Linear layer: X @ A.T + B</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="tensor-manipulation">
<h3><a class="toc-backref" href="#id57" role="doc-backlink">Tensor Manipulation</a><a class="headerlink" href="#tensor-manipulation" title="Link to this heading"><span>¶</span></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transpose with custom permutation</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">permutation</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># Reshape/view tensor</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>

<span class="c1"># Concatenate tensors along an axis</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="element-wise-operations">
<h3><a class="toc-backref" href="#id58" role="doc-backlink">Element-wise Operations</a><a class="headerlink" href="#element-wise-operations" title="Link to this heading"><span>¶</span></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exponential</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Logarithm</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="c1"># Absolute value</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="neural-network-operations">
<h3><a class="toc-backref" href="#id59" role="doc-backlink">Neural Network Operations</a><a class="headerlink" href="#neural-network-operations" title="Link to this heading"><span>¶</span></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 2D Convolution (NCHW format)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Max pooling</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">maxpool</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># Sum pooling</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">sumpool</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>

<span class="c1"># ReLU activation</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

<span class="c1"># Softmax</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="templates-and-type-parameters">
<h2><a class="toc-backref" href="#id60" role="doc-backlink">Templates and Type Parameters</a><a class="headerlink" href="#templates-and-type-parameters" title="Link to this heading"><span>¶</span></a></h2>
<p>Allo supports parameterized kernels using type parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kernel</span><span class="p">[</span><span class="n">Ty</span><span class="p">](</span><span class="n">flag</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Ty&quot;</span><span class="p">:</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">Ty</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">X</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">customize</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">instantiate</span><span class="o">=</span><span class="p">[</span><span class="n">int8</span><span class="p">])</span>
</pre></div>
</div>
<p>For more details on templates, see the <a class="reference internal" href="../gallery/dive_02_template.html"><span class="doc">Template Kernels</span></a> documentation.</p>
</section>
<section id="building-and-execution">
<h2><a class="toc-backref" href="#id61" role="doc-backlink">Building and Execution</a><a class="headerlink" href="#building-and-execution" title="Link to this heading"><span>¶</span></a></h2>
<p>After defining a kernel, create a schedule and build the executable:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">allo</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">allo</span><span class="o">.</span><span class="n">customize</span><span class="p">(</span><span class="n">gemm</span><span class="p">)</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>  <span class="c1"># Default: LLVM backend</span>

<span class="c1"># Prepare inputs</span>
<span class="n">np_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">np_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="c1"># Execute</span>
<span class="n">np_C</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">np_A</span><span class="p">,</span> <span class="n">np_B</span><span class="p">)</span>
</pre></div>
</div>
<p>For HLS code generation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="s2">&quot;vhls&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mod</span><span class="o">.</span><span class="n">hls_code</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
    
        <div id="show_right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&lt;</span><span>Page contents</span></a></p>
        </div>

        <div id="right_sidebar">
            <p><a class="toggle_right_sidebar" href="#"><span class="icon">&gt;</span><span>Page contents:</span></a></p>
            <div class="page_toc">
                <ul>
<li><a class="reference internal" href="#">Frontend Syntax Guide</a><ul>
<li><a class="reference internal" href="#function-definition">Function Definition</a><ul>
<li><a class="reference internal" href="#basic-function-signature">Basic Function Signature</a></li>
<li><a class="reference internal" href="#multiple-return-values">Multiple Return Values</a></li>
<li><a class="reference internal" href="#no-return-value">No Return Value</a></li>
</ul>
</li>
<li><a class="reference internal" href="#variable-declaration-and-assignment">Variable Declaration and Assignment</a><ul>
<li><a class="reference internal" href="#scalar-variables">Scalar Variables</a></li>
<li><a class="reference internal" href="#tensor-variables">Tensor Variables</a></li>
<li><a class="reference internal" href="#initialization-from-lists-and-numpy-arrays">Initialization from Lists and NumPy Arrays</a></li>
<li><a class="reference internal" href="#copy-semantics">Copy Semantics</a></li>
</ul>
</li>
<li><a class="reference internal" href="#loop-constructs">Loop Constructs</a><ul>
<li><a class="reference internal" href="#range-loops">Range Loops</a></li>
<li><a class="reference internal" href="#variable-loop-bounds">Variable Loop Bounds</a></li>
<li><a class="reference internal" href="#grid-loops">Grid Loops</a></li>
<li><a class="reference internal" href="#while-loops">While Loops</a></li>
</ul>
</li>
<li><a class="reference internal" href="#conditional-statements">Conditional Statements</a><ul>
<li><a class="reference internal" href="#if-elif-else">If-Elif-Else</a></li>
<li><a class="reference internal" href="#logical-operators">Logical Operators</a></li>
<li><a class="reference internal" href="#select-expression-ternary">Select Expression (Ternary)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operators">Operators</a><ul>
<li><a class="reference internal" href="#arithmetic-operators">Arithmetic Operators</a></li>
<li><a class="reference internal" href="#unary-operators">Unary Operators</a></li>
<li><a class="reference internal" href="#comparison-operators">Comparison Operators</a></li>
<li><a class="reference internal" href="#bitwise-operators">Bitwise Operators</a></li>
<li><a class="reference internal" href="#augmented-assignment">Augmented Assignment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#array-and-tensor-operations">Array and Tensor Operations</a><ul>
<li><a class="reference internal" href="#indexing">Indexing</a></li>
<li><a class="reference internal" href="#subviews">Subviews</a></li>
<li><a class="reference internal" href="#slicing">Slicing</a></li>
<li><a class="reference internal" href="#bit-operations-on-integers">Bit Operations on Integers</a></li>
<li><a class="reference internal" href="#dynamic-shapes">Dynamic Shapes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nested-functions">Nested Functions</a><ul>
<li><a class="reference internal" href="#index-arguments">Index Arguments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#built-in-functions">Built-in Functions</a><ul>
<li><a class="reference internal" href="#min-and-max">Min and Max</a></li>
<li><a class="reference internal" href="#broadcast-binary-operations">Broadcast Binary Operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#constexpr-compile-time-constants">ConstExpr (Compile-Time Constants)</a><ul>
<li><a class="reference internal" href="#constexpr-arithmetic">ConstExpr Arithmetic</a></li>
<li><a class="reference internal" href="#dependent-constexpr">Dependent ConstExpr</a></li>
<li><a class="reference internal" href="#using-helper-functions">Using Helper Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scoping-rules">Scoping Rules</a><ul>
<li><a class="reference internal" href="#reassignment-validity">Reassignment Validity</a></li>
<li><a class="reference internal" href="#valid-scoping">Valid Scoping</a></li>
<li><a class="reference internal" href="#invalid-scoping">Invalid Scoping</a></li>
</ul>
</li>
<li><a class="reference internal" href="#meta-programming-constructs">Meta-Programming Constructs</a><ul>
<li><a class="reference internal" href="#meta-if-elif-else">Meta If/Elif/Else</a></li>
<li><a class="reference internal" href="#meta-for-compile-time-loop-unrolling">Meta For (Compile-Time Loop Unrolling)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tensor-attributes-and-methods">Tensor Attributes and Methods</a><ul>
<li><a class="reference internal" href="#transpose-t">Transpose (.T)</a></li>
<li><a class="reference internal" href="#copy-copy">Copy (.copy)</a></li>
<li><a class="reference internal" href="#bit-reverse-reverse">Bit Reverse (.reverse)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#type-conversion-functions">Type Conversion Functions</a><ul>
<li><a class="reference internal" href="#explicit-type-casting">Explicit Type Casting</a></li>
<li><a class="reference internal" href="#fixed-point-type-attributes">Fixed-Point Type Attributes</a></li>
<li><a class="reference internal" href="#bitcast">Bitcast</a></li>
</ul>
</li>
<li><a class="reference internal" href="#library-operations">Library Operations</a><ul>
<li><a class="reference internal" href="#matrix-operations">Matrix Operations</a></li>
<li><a class="reference internal" href="#tensor-manipulation">Tensor Manipulation</a></li>
<li><a class="reference internal" href="#element-wise-operations">Element-wise Operations</a></li>
<li><a class="reference internal" href="#neural-network-operations">Neural Network Operations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#templates-and-type-parameters">Templates and Type Parameters</a></li>
<li><a class="reference internal" href="#building-and-execution">Building and Execution</a></li>
</ul>
</li>
</ul>

            </div>
        </div>
    

      <div class="clearer"></div>
    </div>
    <div class="button_nav_wrapper">
        <div class="button_nav">
            <div class="left">
                
                <a href="../gallery/tutorial_02_vhls.html">
                    <span class="icon">&lt;</span><span>Vivado/Vitis HLS Backend</span></a>
                
            </div>

            <div class="right">
                
                    <a href="dataflow.html"><span>Dataflow Programming</span><span class="icon">&gt;</span></a>
                
            </div>
        </div>
    </div>


    <div class="footer" role="contentinfo">
    &#169; Copyright 2025, Allo Authors.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    </div>

<p id="theme_credit">Styled using the <a href="https://github.com/piccolo-orm/piccolo_theme">Piccolo Theme</a></p>
  </body>
</html>